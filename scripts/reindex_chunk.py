from subprocess import run

def reindex_chunk():
    # write parquets
    # uploade them to s3
    # find assigned workers
    # upload necessary files to workers (scp may not work because of restricted access)
    pass

    worker-0: 148.113.153.164
    lm01: 141.95.97.109
    lm02: 162.19.169.196
    lm03: 162.19.169.199
    lm04: 162.19.169.200
    lm05: 162.19.169.201
    rb01: 37.59.18.185
    rb02: 141.95.172.117
    rb03: 57.128.97.235
    rb04: 37.59.18.186
    rb05: 37.59.18.187
    rb06: 162.19.99.159
    rbx01: 51.77.21.115
    rbx02: 51.77.21.116
    rbx03: 51.77.21.117
    rbx04: 51.77.21.118
    sb01: 141.94.142.12
    gr01: 135.125.67.218
    gr02: 135.125.67.219
    gr03: 135.125.67.217
    /var/sqa/data/czM6Ly9zb2xhbmEtbWFpbm5ldC0w
def main():
    chunks = [
        '0227000000/0227170950-0227171499-CF8Je', rb04 sb01
        '0227629050/0227874900-0227875449-CXAbs', lm03 rbx03
        '0228000000/0228003200-0228003999-pETgj', rbx01 gr01
        '0229000000/0229077600-0229078199-64eYw', rb03 lm01
        '0229000000/0229146400-0229146949-HjFF3', rbx03 rb04
        '0229307250/0229494400-0229494949-H4XzS', gr01 lm02
        '0229307250/0229569800-0229570449-Fw5G2', sb01 rb01
        '0229646000/0229784300-0229784949-9Aofv', gr02
        '0231000000/0231104900-0231105599-3ZkKX', rb02 sb01
        '0232000000/0232120000-0232120699-2Drez', lm02 gr01
        '0232355850/0232592700-0232593349-76vtr', lm02 rbx04
        '0232739950/0232854250-0232855049-APJHA', sb01 gr02
        '0234000000/0234180050-0234180599-EFZHU', gr01 lm05
        '0236000000/0236071200-0236071749-CfnV9', gr01 rbx01
        '0239253550/0239345150-0239345649-5nu81', lm03 gr01
        '0239253550/0239396450-0239396999-2se8N', lm01 gr02
        '0242543350/0242589950-0242590449-G1aPM', gr02 worker-0
        '0243600000/0243659850-0243660349-GcHsN', lm04 worker-0
        '0244970850/0245012900-0245013399-HvPom' worker-0
        
    ]
    reindex_chunk()


if __name__ == '__main__':
    main()
